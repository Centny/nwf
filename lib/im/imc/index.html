<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Web</title>
        <!--[if lt IE 8]><script src="./lib/json3.min.js"></script><![endif]-->
        <script src="./socket.io/socket.io.js"></script>
        <script type="text/javascript">
        	function str2ab(str) {
			    var buf = new ArrayBuffer(str.length*2); // 每个字符占用2个字节
			    var bufView = new Uint16Array(buf);
			    for (var i=0, strLen=str.length; i<strLen; i++) {
			         bufView[i] = str.charCodeAt(i);
			    }
			    return buf;
			}
			function ab2str(buf) {
   				return String.fromCharCode.apply(null, new Uint16Array(buf));
			}
			function stringToUint(string) {
				var string = unescape(encodeURIComponent(string)),
				charList = string.split(''),
				uintArray = [];
				for (var i = 0; i < charList.length; i++) {
					uintArray.push(charList[i].charCodeAt(0));
				}
				return new Uint8Array(uintArray);
			}
			function uintToString(uintArray) {
			    var encodedString = String.fromCharCode.apply(null, uintArray),
			        decodedString = decodeURIComponent(escape(encodedString));
			    return decodedString;
			}
			var chat = io.connect('http://localhost:3000/w.io');
			chat.on('connect', function () {
				chat.emit("li",{token:"abc"});
			});
			chat.on('li',function(v){
				console.log(v);
			});
			var ssa=null;
			chat.on("ms",function(v){
				ssa=v;
				// console.log(v);
				console.log(uintToString(new Uint8Array(v.c)));
			});
        </script>
    </head>
    <body>

    </body>
</html>
